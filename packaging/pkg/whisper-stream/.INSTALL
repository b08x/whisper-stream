#! /usr/bin/env bash

# DESCRIPTION
# Post-install script for whisper-stream package

# Bashsmith template patterns for safety
set -o nounset
set -o errexit
set -o pipefail
IFS=$'\n\t'

# CONSTANTS
readonly PACKAGE_NAME="whisper-stream"
readonly CONFIG_DIR="/etc/$PACKAGE_NAME"
readonly USER_CONFIG_DIR="$HOME/.config/$PACKAGE_NAME"

# FUNCTIONS
print_info() {
    printf "\n==> %s\n" "$1"
}

print_note() {
    printf "\n:: %s\n" "$1"
}

# INSTALLATION
post_install() {
    print_info "whisper-stream installation complete"
    
    print_note "Configuration:"
    printf "  - Example config: %s/config.example\n" "$CONFIG_DIR"
    printf "  - User config: %s/config\n" "$USER_CONFIG_DIR"
    
    print_note "Getting started:"
    printf "  1. Set your Groq API key: export GROQ_API_KEY='your-key-here'\n"
    printf "  2. Run: whisper-stream\n"
    printf "  3. Follow the interactive prompts\n"
    
    print_note "Documentation:"
    printf "  - README: /usr/share/doc/%s/README.md\n" "$PACKAGE_NAME"
    printf "  - Development guide: /usr/share/doc/%s/CLAUDE.md\n" "$PACKAGE_NAME"
}

# UPGRADE
post_upgrade() {
    print_info "whisper-stream upgraded successfully"
    
    print_note "Check for new configuration options in:"
    printf "  %s/config.example\n" "$CONFIG_DIR"
}

# REMOVAL
post_remove() {
    print_info "whisper-stream removed"
    
    print_note "User configuration preserved in:"
    printf "  %s/\n" "$USER_CONFIG_DIR"
}